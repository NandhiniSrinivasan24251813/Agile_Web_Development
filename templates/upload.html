
{% extends 'base.html' %}

{% block title %}Upload Data - Epidemic Monitoring System{% endblock %}

{% block content %}
<div class="container">
    <h1 class="mb-4">Upload Epidemic Dataset</h1>
    
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <div class="card">
                <div class="card-body">
                    <form method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        
                        <div class="mb-3">
                            <label for="name" class="form-label">Dataset Name</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                            <div class="form-text">Choose a descriptive name for your dataset</div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="description" class="form-label">Description</label>
                            <textarea class="form-control" id="description" name="description" rows="3"></textarea>
                            <div class="form-text">Briefly describe what this dataset contains</div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="data_type" class="form-label">Data Type</label>
                                <select class="form-control" id="data_type" name="data_type" required>
                                    <option value="cases">Case Data</option>
                                    <option value="deaths">Mortality Data</option>
                                    <option value="vaccinations">Vaccination Data</option>
                                    <option value="hospitalizations">Hospitalization Data</option>
                                    <option value="testing">Testing Data</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            
                            <div class="col-md-6">
                                <label for="sharing_status" class="form-label">Sharing Preference</label>
                                <select class="form-control" id="sharing_status" name="sharing_status" required>
                                    <option value="private">Private (only me)</option>
                                    <option value="public">Public (everyone)</option>
                                    <option value="limited">Limited (select users)</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label d-block">Data Contains</label>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="has_geo" name="has_geo" value="1">
                                <label class="form-check-label" for="has_geo">Geographic coordinates (latitude/longitude)</label>
                            </div>
                            
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="has_time" name="has_time" value="1">
                                <label class="form-check-label" for="has_time">Time series data (dates)</label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="file" class="form-label">Upload File</label>
                            <input type="file" class="form-control" id="file" name="file" required>
                            <div class="form-text">Accepted formats: CSV, JSON, Excel (.xlsx, .xls)</div>
                        </div>
                        
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <button type="submit" class="btn btn-primary" id="upload-btn">
                                <i class="bi bi-upload me-2"></i>Upload & Process
                            </button>
                            <a href="{{ url_for('dashboard') }}" class="btn btn-light">
                                <i class="bi bi-x-circle me-2"></i>Cancel
                            </a>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="card mt-4">
                <div class="card-header">
                    <h5>File Format Requirements</h5>
                </div>
                <div class="card-body">
                    <p>For proper visualization, your data should include:</p>
                    <ul>
                        <li><strong>Geographic coordinates</strong>: Columns named 'latitude' and 'longitude' (or 'lat'/'lon')</li>
                        <li><strong>Date information</strong>: A column with date values (e.g., 'date', 'report_date')</li>
                        <li><strong>Location names</strong>: Columns for location names (e.g., 'location', 'city', 'country')</li>
                        <li><strong>Epidemic metrics</strong>: Columns for case counts, deaths, etc.</li>
                    </ul>
                    
                    <div class="mt-3">
                        <div class="accordion" id="sampleFormatAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="headingOne">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                                        View Sample Format
                                    </button>
                                </h2>
                                <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#sampleFormatAccordion">
                                    <div class="accordion-body">
                                        <h6>Sample CSV Format:</h6>
                                        <pre class="bg-light p-2"><code>date,location,latitude,longitude,cases,deaths,recovered
2023-01-01,New York,40.7128,-74.0060,120,5,80
2023-01-01,Los Angeles,34.0522,-118.2437,90,3,50
2023-01-02,New York,40.7128,-74.0060,140,7,95
2023-01-02,Los Angeles,34.0522,-118.2437,105,4,70</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/submission-handler.js') }}"></script>
{% endblock %}