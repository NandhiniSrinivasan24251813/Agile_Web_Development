{% extends 'base.html' %} {% block title %}Share - {{ dataset.name }} - Epidemic
Monitoring{% endblock %} {% block content %}
<div class="max-w-3xl mx-auto">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold">Share Dataset: {{ dataset.name }}</h1>
    <div>
      <a href="{{ url_for('dashboard') }}" class="text-blue-600 hover:underline"
        >‚Üê Back to Dashboard</a
      >
    </div>
  </div>

  <div class="bg-blue-50 p-4 rounded-lg mb-8">
    <h2 class="text-lg font-semibold mb-2">About Sharing</h2>
    <p class="text-gray-700 mb-2">
      Share your dataset with specific users to give them access to view and
      analyze your data.
    </p>
    <ul class="list-disc ml-5 text-gray-700">
      <li>Users you share with can view your dataset but cannot modify it</li>
      <li>You can revoke access at any time</li>
      <li>
        Shared users will see this dataset in their "Shared With You" section
      </li>
    </ul>
  </div>

  <div class="bg-white p-6 rounded-lg shadow-md mb-8">
    <h2 class="text-xl font-semibold mb-4">Share with a User</h2>

    <form method="POST" action="{{ url_for('share', dataset_id=dataset.id) }}">
      <div class="mb-4">
        <label for="username" class="block text-gray-700 font-medium mb-2"
          >Username</label
        >
        <input
          type="text"
          id="username"
          name="username"
          required
          class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          placeholder="Enter username to share with"
        />
      </div>

      <div class="flex justify-end">
        <button
          type="submit"
          class="bg-blue-600 text-white py-2 px-6 rounded-lg hover:bg-blue-700 transition duration-300 flex items-center"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 mr-2"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"
            />
          </svg>
          Share Dataset
        </button>
      </div>
    </form>
  </div>

  <div class="bg-white p-6 rounded-lg shadow-md">
    <h2 class="text-xl font-semibold mb-4">Currently Shared With</h2>

    {% if shared_users %}
    <div class="space-y-4">
      {% for shared in shared_users %}
      <div class="border rounded-lg p-4 flex justify-between items-center">
        <div>
          <h3 class="font-semibold">{{ shared.shared_user.username }}</h3>
          <p class="text-sm text-gray-600">
            Shared on {{ shared.share_date.strftime('%B %d, %Y') }}
          </p>
        </div>
        <a
          href="{{ url_for('revoke_share', share_id=shared.id) }}"
          class="text-red-600 hover:underline text-sm flex items-center"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-4 w-4 mr-1"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1H10a1 1 0 00-1 1v3M4 7h16"
            />
          </svg>
          Revoke Access
        </a>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-8">
      <p class="text-gray-500">
        This dataset is not shared with any users yet.
      </p>
    </div>
    {% endif %}

    <div class="mt-8">
      <h3 class="font-semibold mb-3">Generate Shareable Link</h3>
      <div class="flex space-x-2">
        <input
          type="text"
          id="share-link"
          class="flex-grow px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
          value="{{ url_for('share_link', token=dataset.shared_with[0].access_token if dataset.shared_with else '', _external=True) }}"
          readonly
        />
        <button
          id="copy-link"
          class="bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition duration-300"
        >
          Copy
        </button>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block scripts %}
<script src="{{ url_for('static', filename='js/share.js') }}"></script>
{% endblock %}
